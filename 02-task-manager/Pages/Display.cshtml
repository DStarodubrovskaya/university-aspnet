@page
@using TaskManagerDariaSt.Models;
@model TaskManagerDariaSt.Pages.DisplayModel
<h1 class="text-center mb-4">Display Tasks</h1>

<!-- Filters and buttons -->
<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">

    <!-- Filter tasks by user and status -->
    <form method="post" asp-page-handler="DisplayByUserAndStatus" class="d-flex align-items-center gap-2 flex-wrap">

        <!-- User filter -->
        <div class="d-flex align-items-center gap-2"> 
            <!-- Dropdown with user list -->
            <label asp-for="user.Id" class="me-1">Select User</label>
            <select asp-for="user.Id" asp-items="@(new SelectList(Model.Users, "Id", "FullName"))" class="form-select form-select-sm" style="width: 150px;">
                <option value="all">All</option>
            </select>
        </div>
        <!-- Status filter -->
        <div class="d-flex align-items-center gap-2">
            <!-- Dropdown with status list -->
            <label asp-for="taskItem.Status" class="me-1">Select Status</label>
            <select asp-for="taskItem.Status" class="form-select form-select-sm" style="width: 150px;">
                <option value="all">All</option>
                <option value="Not started">Not started</option>
                <option value="In progress">In progress</option>
                <option value="Completed">Completed</option>
            </select>
        </div>
        <!-- Search button -->
        <button class="btn btn-primary btn-sm">Display Tasks</button>
    </form>

    <!-- Quick links to manage tasks and users -->
    <div class="d-flex gap-2">
        <a href="/Tasks" class="btn btn-secondary">Manage Tasks</a>
        <a href="/Users" class="btn btn-secondary">Manage Users</a>
    </div>
</div>

<!--Main Table-->
<div>
    <table class="table table-striped table-bordered">
        <thead class="table-light">
            <tr>
                <th>Task</th>
                <th>Description</th>
                <th>Assignee</th>
                <th>Status</th>
                <th>Deadline</th>
                <th>Update</th>
            </tr>
        </thead>
        <tbody>
            @foreach (TaskItem task in Model.Tasks)
            {
                <tr>
                    <td>@task.Title</td>
                    <td>@task.Description</td>
                    <td>@task.AssignedToUserName</td>
                    <td>@task.Status</td>
                    <td>
                        @task.DueDate.ToString("yyyy-MM-dd HH:mm")
                    </td>
                    <td><a asp-page="/UpdateTask" asp-route-id="@task.Id">Update Task</a></td>
                </tr>
            }
        </tbody>
    </table>
    <br />

    <!-- If no tasks found, show info alert -->
    @if (!Model.HasTasks)
    {
        <div class="alert alert-info">
            <p>No tasks have been found.</p>
            <p><a href="/Tasks" class="btn btn-warning">Manage Task</a></p>
        </div>
    }
</div>
<!-- Back to main menu button -->
<div class="text-center">
    <p class="mt-3">
        <a href="/Index" class="btn btn-outline-primary">Back to Main Menu</a>
    </p>
</div> 